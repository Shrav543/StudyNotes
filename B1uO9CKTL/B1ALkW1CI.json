{"_id":"B1ALkW1CI","title":"Routes:","dateCreated":1592885078303,"lastAccessed":"2020-06-23T04:04:38.305Z","lastUpdated":"2020-06-23T04:07:04.091Z","notebookId":"B1uO9CKTL","body":{"blocks":[{"key":"ag6qs","text":"Routes:","type":"header-one","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"a8q2g","text":"","type":"unstyled","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"27ov3","text":"","type":"unstyled","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"b34ig","text":"","type":"unstyled","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"bt3hq","text":"","type":"unstyled","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"aab6i","text":"","type":"unstyled","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"cndrn","text":"from flaskblog.models import User, Post","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"1b1sq","text":"from flask import render_template, url_for, flash, redirect , request , abort","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"5l79m","text":"from flaskblog.forms import RegistrationForm, LoginForm , PostForm","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"eh6jk","text":"from flaskblog import app,db,bcrypt","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"e1fp0","text":"from flask_login import login_user,current_user,logout_user,login_required","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"8mm1i","text":"","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"5o4g0","text":"","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"19teh","text":"@app.route(\"/home\")","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[{"offset":0,"length":19,"style":"BOLD"}],"entityRanges":[],"data":{}},{"key":"ba9dg","text":"@app.route(\"/\")","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[{"offset":0,"length":15,"style":"BOLD"}],"entityRanges":[],"data":{}},{"key":"55sap","text":"def home():","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[{"offset":4,"length":4,"style":"BOLD"}],"entityRanges":[],"data":{}},{"key":"788nd","text":"\tposts= Post.query.all()","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"bgil6","text":"\treturn render_template('home.html',posts=posts)","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"9lohq","text":"","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"anqgk","text":"@app.route(\"/about\")","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"1gqd1","text":"def about():","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[{"offset":4,"length":5,"style":"BOLD"}],"entityRanges":[],"data":{}},{"key":"dtktm","text":"\treturn render_template('about.html', title='About')","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"d6q93","text":"","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"fjklu","text":"# We must put the allowed methods otherwise while submitting there would be an error","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"3kiiv","text":"@app.route(\"/register\", methods=['GET','POST'])","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"20fvc","text":"def register():","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[{"offset":4,"length":8,"style":"BOLD"}],"entityRanges":[],"data":{}},{"key":"569a9","text":"\tif current_user.is_authenticated:","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"5rs79","text":"\t\treturn redirect(url_for('home'))","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"4tqs1","text":"\tform = RegistrationForm()","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"82l4h","text":"\tif form.validate_on_submit():","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"4oqef","text":"\t\t# this is a one time msg that we can use importing from flask flash, it also excepts other args like success","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"fij25","text":"\t\thashed_password = bcrypt.generate_password_hash(form.password.data).decode('utf-8')","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"504vb","text":"\t\tuser = User(username = form.username.data, email=form.email.data, password = hashed_password)","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"4t889","text":"\t\tdb.session.add(user)","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"5ap9m","text":"\t\tdb.session.commit()\t","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"72qqp","text":"\t\tflash(f'Account created for {form.username.data}', 'success')","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"cu869","text":"\t\treturn redirect(url_for('login'))","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"ct7or","text":"\treturn render_template('register.html', title='Register',form=form)","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"dgpns","text":"","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"bgkej","text":"","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"77hq7","text":"@app.route(\"/login\",methods=['GET','POST'])","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"58a2m","text":"def login():","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[{"offset":4,"length":5,"style":"BOLD"}],"entityRanges":[],"data":{}},{"key":"chssc","text":"\tif current_user.is_authenticated:","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"fmnb3","text":"\t\treturn redirect(url_for('home'))","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"4ra7n","text":"\tform = LoginForm()","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"ceu68","text":"","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"5qc97","text":"\tif form.validate_on_submit():","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"cg1lt","text":"","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"3dlqa","text":"\t\tuser= User.query.filter_by(email=form.email.data).first()","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"72d55","text":"","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"60a6g","text":"\t\tif user and bcrypt.check_password_hash(user.password, form.password.data):","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"fctv1","text":"\t\t\tlogin_user(user, remember=form.remember.data)","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"782ok","text":"\t\t\tnext_page = request.args.get('next')","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"6rdo5","text":"\t\t\tif next_page:","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"60mm6","text":"\t\t\t\treturn redirect(next_page)","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"9jfms","text":"\t\t\telse:","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"eegtj","text":"\t\t\t\treturn redirect(url_for('home'))","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"2hsti","text":"\t\telse:","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"4r6rk","text":"\t\t\tflash(f'Please check your credentials', 'danger')","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"7n5vf","text":"\t","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"c0iug","text":"\treturn render_template('login.html', title='Login',form=form)","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"5r41g","text":"","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"9m624","text":"@app.route(\"/logout\")","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"buimq","text":"@login_required","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"2hfct","text":"def logout():","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[{"offset":4,"length":6,"style":"BOLD"}],"entityRanges":[],"data":{}},{"key":"8ko1e","text":"\tlogout_user()","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"7sroh","text":"\treturn redirect(url_for('home'))","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"1on8t","text":"","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"autp4","text":"","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"eqqp3","text":"","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"ab1g1","text":"@app.route(\"/account\")","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"4nj1n","text":"@login_required","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"1nams","text":"def account():\t","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[{"offset":4,"length":7,"style":"BOLD"}],"entityRanges":[],"data":{}},{"key":"e52e9","text":"\treturn render_template('account.html', title='Account')","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"49saa","text":"","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"beoqu","text":"","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"4cmat","text":"@app.route(\"/post/new\", methods=['GET','POST'])","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"9bqam","text":"@login_required","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"argt1","text":"def new_post():\t","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[{"offset":4,"length":8,"style":"BOLD"}],"entityRanges":[],"data":{}},{"key":"8bvno","text":"\tform = PostForm()","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"8skdu","text":"\tif form.validate_on_submit():","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"9718l","text":"\t\tpost = Post(title=form.title.data, content=form.content.data , author=current_user)","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"8l0mu","text":"\t\tdb.session.add(post)","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"b47ba","text":"\t\tdb.session.commit()","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"8v75q","text":"\t\tflash(f'Your post has been created', 'success')","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"476r","text":"\t\treturn redirect(url_for('home'))","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"1kkgu","text":"\treturn render_template('create_post.html', title='New Post',form=form, legend='New Post')","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"9p7en","text":"","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"9fgn2","text":"","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"fq9dc","text":"","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"fjjjs","text":"","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"8vr7k","text":"@app.route(\"/post/<int:post_id>\")","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"2f0lj","text":"#@login_required","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"41v5g","text":"def post(post_id):","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[{"offset":4,"length":4,"style":"BOLD"}],"entityRanges":[],"data":{}},{"key":"bcgu8","text":"\t#post = Post.query.get(post_id)","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"f0g10","text":"\tpost = Post.query.get_or_404(post_id)","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"9ouvk","text":"\treturn render_template('post.html',title=post.title,post=post)","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"oo89","text":"","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"atcph","text":"","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"2sfn3","text":"@app.route(\"/post/<int:post_id>/update\",methods=['GET','POST'])","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"an71u","text":"@login_required","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"ba97q","text":"def update_post(post_id):","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[{"offset":4,"length":11,"style":"BOLD"}],"entityRanges":[],"data":{}},{"key":"cbbh6","text":"\t#post = Post.query.get(post_id)","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"6at34","text":"\tpost = Post.query.get_or_404(post_id)","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"6sqco","text":"\tif post.author == current_user:","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"7md3k","text":"\t\tform = PostForm()","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"bk5m0","text":"\t\tif form.validate_on_submit():","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"e99ql","text":"\t\t\tpost.title = form.title.data","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"7rcdb","text":"\t\t\tpost.content = form.content.data","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"2mgon","text":"\t\t\tdb.session.commit()","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"3rg4g","text":"\t\t\tflash(\"Your post has been updated!\",\"success\")","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"b6lt0","text":"\t\t\treturn redirect(url_for('post', post_id=post.id))","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"8mj55","text":"","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"8ip54","text":"\t\telif request.method =='GET':","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"7djp9","text":"\t\t\tform.title.data = post.title","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"bhlro","text":"\t\t\tform.content.data = post.content","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"fmp4f","text":"\t\treturn render_template('create_post.html', title='Update Post',form=form,legend='Update Post')","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"95djj","text":"\telse:","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"4rng1","text":"\t\tabort(403)","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"2qjei","text":"","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"aj8cc","text":"","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"72pbq","text":"@app.route(\"/post/<int:post_id>/delete\",methods=['POST'])","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"212lj","text":"@login_required","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"bb4j9","text":"def delete_post(post_id):","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[{"offset":4,"length":10,"style":"BOLD"}],"entityRanges":[],"data":{}},{"key":"eh1k8","text":"\tpost = Post.query.get_or_404(post_id)","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"3qm2i","text":"\tif post.author != current_user:","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"6ams4","text":"\t\tabort(403)","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"11oc0","text":"\tdb.session.delete(post)","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"83egb","text":"\tdb.session.commit()","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"fk8n4","text":"\tflash(\"Your post has been deleted!\",\"success\")","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"2e9p5","text":"\treturn redirect(url_for('home'))","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"flrdc","text":"","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"36b6f","text":"","type":"custom-code-block-python","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}},{"key":"59kd9","text":"","type":"unstyled","depth":0,"inlineStyleRanges":[],"entityRanges":[],"data":{}}],"entityMap":{}},"tags":[]}
